---
import '../styles/global.css';
interface Props {
  title: string;
  description?: string;
  ogImage?: string;
}
const { title, description = 'FluentGe â€” áƒ£áƒ¤áƒáƒ¡áƒ áƒ˜áƒœáƒ’áƒšáƒ˜áƒ¡áƒ£áƒ áƒ˜ áƒ”áƒœáƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒ¬áƒáƒ•áƒšáƒ áƒ¥áƒáƒ áƒ—áƒ•áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡. 5,250+ áƒ¡áƒ˜áƒ¢áƒ§áƒ•áƒ, 65 áƒ’áƒ áƒáƒ›áƒáƒ¢áƒ˜áƒ™áƒ˜áƒ¡ áƒ’áƒáƒ™áƒ•áƒ”áƒ—áƒ˜áƒšáƒ˜, 35 áƒáƒáƒ“áƒ™áƒáƒ¡áƒ¢áƒ˜ áƒ“áƒ 1,695 áƒ¤áƒ áƒáƒ–áƒ áƒáƒ£áƒ“áƒ˜áƒáƒ—áƒ˜.', ogImage = '/og-image.svg' } = Astro.props;
const canonicalUrl = new URL(Astro.url.pathname, 'https://fluentge.surge.sh');
---

<html lang="ka">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalUrl.href} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalUrl.href} />
    <meta property="og:image" content={`https://fluentge.surge.sh${ogImage}`} />
    <meta property="og:locale" content="ka_GE" />
    <meta property="og:site_name" content="FluentGe" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={`https://fluentge.surge.sh${ogImage}`} />

    <!-- SEO extras -->
    <meta name="keywords" content="áƒ˜áƒœáƒ’áƒšáƒ˜áƒ¡áƒ£áƒ áƒ˜, áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜, áƒ¡áƒ¬áƒáƒ•áƒšáƒ, English, Georgian, learn English, FluentGe, áƒ¤áƒšáƒ”áƒ¨áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜, áƒ’áƒ áƒáƒ›áƒáƒ¢áƒ˜áƒ™áƒ, áƒáƒáƒ“áƒ™áƒáƒ¡áƒ¢áƒ˜" />
    <meta name="author" content="FluentGe" />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#1C1C1E" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>{title}</title>
    <script is:inline>if(localStorage.getItem('fluentge-theme')==='light')document.documentElement.classList.add('light');</script>

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "FluentGe",
      "alternateName": "áƒ¤áƒšáƒ£áƒ”áƒœáƒ¢áƒ¯áƒ˜",
      "url": "https://fluentge.surge.sh",
      "description": "áƒ£áƒ¤áƒáƒ¡áƒ áƒ˜áƒœáƒ’áƒšáƒ˜áƒ¡áƒ£áƒ áƒ˜ áƒ”áƒœáƒ˜áƒ¡ áƒ¨áƒ”áƒ¡áƒ¬áƒáƒ•áƒšáƒ áƒ¥áƒáƒ áƒ—áƒ•áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ â€” áƒ¤áƒšáƒ”áƒ¨áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜, áƒ’áƒ áƒáƒ›áƒáƒ¢áƒ˜áƒ™áƒ, áƒáƒáƒ“áƒ™áƒáƒ¡áƒ¢áƒ˜, áƒ—áƒáƒ›áƒáƒ¨áƒ”áƒ‘áƒ˜",
      "inLanguage": ["ka", "en"],
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://fluentge.surge.sh/flashcards/?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    })} />
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "EducationalOrganization",
      "name": "FluentGe",
      "url": "https://fluentge.surge.sh",
      "description": "Free English learning platform for Georgian speakers",
      "areaServed": { "@type": "Country", "name": "Georgia" },
      "teaches": "English language"
    })} />
    <style>
      * { cursor: default; }
      a, button, [role="button"], input[type="submit"], .clickable, [onclick] { cursor: pointer !important; }
      input, textarea, select { cursor: text; }
    </style>
  </head>
  <body class="bg-[#1C1C1E] text-[#F5F5F0] font-[Inter,system-ui,sans-serif] min-h-screen">
    <nav class="fixed top-0 w-full z-50 bg-[#1C1C1E]/95 backdrop-blur-md border-b border-[#2E2E30]">
      <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between gap-6">
        <a href="/" class="font-['Playfair_Display',serif] text-xl sm:text-2xl tracking-tight flex-shrink-0">
          <span class="text-[#C8C8C0]">Fluent</span><span class="text-white">Ge</span>
        </a>
        <div class="hidden lg:flex items-center gap-5 text-sm text-[#A0A09A]">
          <a href="/" class="hover:text-white transition-colors">áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜</a>
          <a href="/flashcards/" class="hover:text-white transition-colors">áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜</a>
          <a href="/grammar/" class="hover:text-white transition-colors">áƒ’áƒ áƒáƒ›áƒáƒ¢áƒ˜áƒ™áƒ</a>
          <a href="/phrases/" class="hover:text-white transition-colors">áƒ¤áƒ áƒáƒ–áƒ”áƒ‘áƒ˜</a>
          <a href="/games/" class="hover:text-white transition-colors">áƒ—áƒáƒ›áƒáƒ¨áƒ”áƒ‘áƒ˜</a>
          <a href="/podcast/" class="hover:text-white transition-colors">áƒáƒáƒ“áƒ™áƒáƒ¡áƒ¢áƒ˜</a>
          <a href="/blog/" class="hover:text-white transition-colors">áƒ‘áƒšáƒáƒ’áƒ˜</a>
          <a href="/about/" class="hover:text-white transition-colors">áƒ¨áƒ”áƒ¡áƒáƒ®áƒ”áƒ‘</a>
          <a href="/premium/" class="bg-[#C8C8C0] text-[#1C1C1E] px-5 py-2 rounded-lg font-semibold hover:bg-[#E8E8E0] transition-colors">áƒáƒ áƒ”áƒ›áƒ˜áƒ£áƒ›áƒ˜</a>
        </div>
        <div class="flex items-center gap-2">
          <button id="theme-toggle" class="text-lg hover:scale-110 transition-transform p-1" title="áƒ—áƒ”áƒ›áƒ˜áƒ¡ áƒ¨áƒ”áƒªáƒ•áƒšáƒ" aria-label="áƒ—áƒ”áƒ›áƒ˜áƒ¡ áƒ¨áƒ”áƒªáƒ•áƒšáƒ">
            â˜€ï¸
          </button>
          <button id="menu-toggle" class="lg:hidden text-white p-1" aria-label="áƒ›áƒ”áƒœáƒ˜áƒ£">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
          </button>
          <a href="/login/" id="nav-login" class="text-sm border border-[#2E2E30] px-4 py-1.5 rounded-lg hover:bg-[#242426] transition-colors flex items-center gap-1.5">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ
          </a>
          <a href="/account/" id="nav-account" class="hidden text-sm border border-[#2E2E30] px-4 py-1.5 rounded-lg hover:bg-[#242426] transition-colors flex items-center gap-1.5" title="áƒáƒœáƒ’áƒáƒ áƒ˜áƒ¨áƒ˜">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
            <span id="nav-account-name"></span>
          </a>
        </div>
      </div>
      <div id="mobile-menu" class="hidden lg:hidden border-t border-[#2E2E30] bg-[#1C1C1E]/98">
        <div class="flex flex-col px-4 py-3 gap-3 text-sm text-[#A0A09A]">
          <a href="/" class="hover:text-white py-1">áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜</a>
          <a href="/flashcards/" class="hover:text-white py-1">áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜</a>
          <a href="/grammar/" class="hover:text-white py-1">áƒ’áƒ áƒáƒ›áƒáƒ¢áƒ˜áƒ™áƒ</a>
          <a href="/phrases/" class="hover:text-white py-1">áƒ¤áƒ áƒáƒ–áƒ”áƒ‘áƒ˜</a>
          <a href="/games/" class="hover:text-white py-1">áƒ—áƒáƒ›áƒáƒ¨áƒ”áƒ‘áƒ˜</a>
          <a href="/podcast/" class="hover:text-white py-1">áƒáƒáƒ“áƒ™áƒáƒ¡áƒ¢áƒ˜</a>
          <a href="/blog/" class="hover:text-white py-1">áƒ‘áƒšáƒáƒ’áƒ˜</a>
          <a href="/about/" class="hover:text-white py-1">áƒ¨áƒ”áƒ¡áƒáƒ®áƒ”áƒ‘</a>
          <a href="/premium/" class="bg-[#C8C8C0] text-[#1C1C1E] px-4 py-2.5 rounded-lg font-semibold text-center hover:bg-[#E8E8E0]">áƒáƒ áƒ”áƒ›áƒ˜áƒ£áƒ›áƒ˜</a>
          <a href="/login/" id="nav-login-mobile" class="hover:text-white py-1">áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ</a>
          <a href="/account/" id="nav-account-mobile" class="hidden hover:text-white py-1">áƒáƒœáƒ’áƒáƒ áƒ˜áƒ¨áƒ˜</a>
        </div>
      </div>
    </nav>
    <script>document.getElementById('menu-toggle')?.addEventListener('click',()=>{document.getElementById('mobile-menu')?.classList.toggle('hidden');});</script>
    
    <script>
      // Theme toggle - uses .light class on <html>
      (function() {
        var t = localStorage.getItem('fluentge-theme');
        if (t === 'light') document.documentElement.classList.add('light');
        var btn = document.getElementById('theme-toggle');
        if (!btn) return;
        btn.textContent = t === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
        btn.addEventListener('click', function() {
          document.documentElement.classList.toggle('light');
          var isLight = document.documentElement.classList.contains('light');
          localStorage.setItem('fluentge-theme', isLight ? 'light' : 'dark');
          btn.textContent = isLight ? 'ğŸŒ™' : 'â˜€ï¸';
        });
      })();
      // Auth nav toggle + premium check
      (function() {
        var PREMIUM_EMAILS = ['tokakhozre@gmail.com'];
        var u = localStorage.getItem('fluentge-user');
        if (u) {
          var data = JSON.parse(u);
          if (PREMIUM_EMAILS.indexOf(data.email) !== -1) {
            localStorage.setItem('fluentge-premium', 'true');
          }
          var initial = (data.name || data.email || 'U')[0].toUpperCase();
          var el;
          el = document.getElementById('nav-login'); if(el) el.classList.add('hidden');
          el = document.getElementById('nav-login-mobile'); if(el) el.classList.add('hidden');
          el = document.getElementById('nav-account'); if(el) el.classList.remove('hidden');
          el = document.getElementById('nav-account-name'); if(el) el.textContent = data.name || data.email.split('@')[0];
          el = document.getElementById('nav-account-mobile'); if(el) el.classList.remove('hidden');
        }
      })();
    </script>

    <script is:inline type="module">
      import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
      import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-auth.js";
      import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

      const cfg = {apiKey:"AIzaSyBYJ6xzlp6tP7oIQoz9UzfYbjrVgR3JrwQ",authDomain:"fluentge.firebaseapp.com",projectId:"fluentge",storageBucket:"fluentge.firebasestorage.app",messagingSenderId:"140225085227",appId:"1:140225085227:web:d10b8efd8c08a131574f6e"};
      const app = getApps().length ? getApps()[0] : initializeApp(cfg);
      const auth = getAuth(app);
      let db; try { db = getFirestore(app); } catch(e) { console.warn('[Sync] Firestore init failed:', e); }

      function jp(v, f) { try { return JSON.parse(v); } catch { return f; } }
      function mergeArr(a, b) {
        const s = new Set(), r = [];
        for (const i of [...(b||[]), ...(a||[])]) { const k = typeof i==='object'?JSON.stringify(i):i; if(!s.has(k)){s.add(k);r.push(i);} }
        return r;
      }
      function mergeObj(a, b) { return {...(a||{}), ...(b||{})}; }

      function gather() {
        const d = {};
        d.knownCards = jp(localStorage.getItem('knownCards'), []);
        d.learnedPhrases = jp(localStorage.getItem('fluentge-learned-phrases'), []);
        d.learnedGrammar = jp(localStorage.getItem('fluentge-learned-grammar'), []);
        d.learnedPodcasts = jp(localStorage.getItem('fluentge-learned-podcasts'), []);
        d.gameRecords = jp(localStorage.getItem('fluentge-game-records'), {});
        d.premium = localStorage.getItem('fluentge-premium') === 'true';
        d.srsData = {}; d.cardProgress = {};
        for (let i = 0; i < localStorage.length; i++) {
          const k = localStorage.key(i);
          if (k?.startsWith('fluentge-srs-')) d.srsData[k.slice(13)] = jp(localStorage.getItem(k), {});
          if (k?.startsWith('card_progress_')) d.cardProgress[k] = jp(localStorage.getItem(k), {});
        }
        d.flashcardProgress = jp(localStorage.getItem('fluentge_progress'), {});
        d.flashcardStats = jp(localStorage.getItem('fluentge_stats'), {});
        return d;
      }

      function apply(local, cloud) {
        localStorage.setItem('knownCards', JSON.stringify(mergeArr(local.knownCards, cloud.knownCards)));
        localStorage.setItem('fluentge-learned-phrases', JSON.stringify(mergeArr(local.learnedPhrases, cloud.learnedPhrases)));
        localStorage.setItem('fluentge-learned-grammar', JSON.stringify(mergeArr(local.learnedGrammar, cloud.learnedGrammar)));
        localStorage.setItem('fluentge-learned-podcasts', JSON.stringify(mergeArr(local.learnedPodcasts, cloud.learnedPodcasts)));
        localStorage.setItem('fluentge-game-records', JSON.stringify(mergeObj(local.gameRecords, cloud.gameRecords)));
        if (cloud.premium !== undefined) localStorage.setItem('fluentge-premium', cloud.premium ? 'true' : 'false');
        for (const id of new Set([...Object.keys(local.srsData||{}), ...Object.keys(cloud.srsData||{})])) {
          localStorage.setItem('fluentge-srs-' + id, JSON.stringify(mergeObj(local.srsData?.[id], cloud.srsData?.[id])));
        }
        localStorage.setItem('fluentge_progress', JSON.stringify(mergeObj(local.flashcardProgress, cloud.flashcardProgress)));
        localStorage.setItem('fluentge_stats', JSON.stringify(mergeObj(local.flashcardStats, cloud.flashcardStats)));
        for (const k of new Set([...Object.keys(local.cardProgress||{}), ...Object.keys(cloud.cardProgress||{})])) {
          localStorage.setItem(k, JSON.stringify(mergeObj(local.cardProgress?.[k], cloud.cardProgress?.[k])));
        }
      }

      async function loadCloud(uid) {
        if (!db) return;
        try {
          const snap = await getDoc(doc(db, 'users', uid));
          if (snap.exists()) { apply(gather(), snap.data().progress || {}); console.log('[Sync] Loaded from cloud'); }
        } catch (e) { console.warn('[Sync] Load failed:', e.message); }
      }
      async function saveCloud(uid) {
        if (!db) return;
        try {
          const d = gather(); d.lastSync = new Date().toISOString();
          await setDoc(doc(db, 'users', uid), { progress: d }, { merge: true });
          console.log('[Sync] Saved to cloud');
        } catch (e) { console.warn('[Sync] Save failed:', e.message); }
      }

      let iv = null, uid = null;
      onAuthStateChanged(auth, async (user) => {
        if (iv) { clearInterval(iv); iv = null; }
        if (user) {
          uid = user.uid;
          await loadCloud(uid);
          iv = setInterval(() => saveCloud(uid), 30000);
          window.addEventListener('beforeunload', () => saveCloud(uid));
        } else { uid = null; }
      });
      window.__fluentgeSync = { save: () => uid && saveCloud(uid), load: () => uid && loadCloud(uid) };
    </script>
    <main class="pt-14"><slot /></main>

    <footer class="border-t border-[#2E2E30] mt-20 bg-[#161618]">
      <div class="max-w-5xl mx-auto px-4 py-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
          <div>
            <p class="font-['Playfair_Display',serif] text-xl mb-3"><span class="text-[#C8C8C0]">Fluent</span>Ge</p>
            <p class="text-[#6B6B65] text-sm leading-relaxed">áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜ áƒ˜áƒœáƒ’áƒšáƒ˜áƒ¡áƒ£áƒ áƒ˜ áƒ”áƒœáƒ˜áƒ¡ áƒáƒšáƒáƒ¢áƒ¤áƒáƒ áƒ›áƒ áƒ¥áƒáƒ áƒ—áƒ•áƒ”áƒšáƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡.</p>
          </div>
          <div>
            <p class="font-semibold text-sm mb-3 text-[#A0A09A]">áƒœáƒáƒ•áƒ˜áƒ’áƒáƒªáƒ˜áƒ</p>
            <div class="flex flex-col gap-2 text-sm text-[#6B6B65]">
              <a href="/" class="hover:text-white transition-colors">áƒ›áƒ—áƒáƒ•áƒáƒ áƒ˜</a>
              <a href="/flashcards/" class="hover:text-white transition-colors">áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜</a>
              <a href="/grammar/" class="hover:text-white transition-colors">áƒ’áƒ áƒáƒ›áƒáƒ¢áƒ˜áƒ™áƒ</a>
              <a href="/games/" class="hover:text-white transition-colors">áƒ—áƒáƒ›áƒáƒ¨áƒ”áƒ‘áƒ˜</a>
            </div>
          </div>
          <div>
            <p class="font-semibold text-sm mb-3 text-[#A0A09A]">áƒ áƒ”áƒ¡áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ˜</p>
            <div class="flex flex-col gap-2 text-sm text-[#6B6B65]">
              <a href="/phrases/" class="hover:text-white transition-colors">áƒ¤áƒ áƒáƒ–áƒ”áƒ‘áƒ˜</a>
              <a href="/podcast/" class="hover:text-white transition-colors">áƒáƒáƒ“áƒ™áƒáƒ¡áƒ¢áƒ˜</a>
              <a href="/blog/" class="hover:text-white transition-colors">áƒ‘áƒšáƒáƒ’áƒ˜</a>
              <a href="/about/" class="hover:text-white transition-colors">áƒ¨áƒ”áƒ¡áƒáƒ®áƒ”áƒ‘</a>
              <a href="/register/" class="hover:text-white transition-colors">áƒ áƒ”áƒ’áƒ˜áƒ¡áƒ¢áƒ áƒáƒªáƒ˜áƒ</a>
            </div>
          </div>
        </div>
        <div class="border-t border-[#2E2E30] pt-6 text-center text-[#6B6B65] text-xs">
          &copy; 2026 FluentGe. áƒ§áƒ•áƒ”áƒšáƒ áƒ£áƒ¤áƒšáƒ”áƒ‘áƒ áƒ“áƒáƒªáƒ£áƒšáƒ˜áƒ.
        </div>
      </div>
    </footer>
  </body>
</html>
